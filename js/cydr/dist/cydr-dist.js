/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){typeof define=="function"&&define.amd?define(t):e.Cydr=t()})(this,function(){var e,t,n;(function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("build/almond",function(){}),n("src/core/base",[],function(){var e=!1,t=0,n=/xyz/.test(function(){var e})?/\b_super\b/:/.*/,r=function(){};return r.extend=function(r){function u(){!e&&this.__construct&&this.__construct.apply(this,arguments)}var i=this.prototype,s;e=!0,s=new this,e=!1;for(var o in r)s[o]=typeof r[o]=="function"&&typeof i[o]=="function"&&n.test(r[o])?function(e,t){return function(){var n=this._super;this._super=i[e];var r=t.apply(this,arguments);return this._super=n,r}}(o,r[o]):r[o];return u.prototype=s,u.prototype._classIdentifier="Class_"+t,t++,u.prototype.constructor=u,u.extend=arguments.callee,u},r}),n("src/core/core",[],function(){var e={};return e.Config={},e.Utils={inArray:function(e,t){for(var n in t)if(t[n]==e)return!0;return!1},forEach:function(e,t,n){for(var r in e){var i=t.apply(n?n:window,[r,e[r]]);if(i===!1)break}}},e.EventDispatcher={events:[],fire:function(t){var n=t.split(":"),r=n[0],i=n[1],s=n[2],o=n[3],u=[];for(var a in n){var f=n[a];u.push(f);var l=u.join(":"),c=e.EventDispatcher.events[l]||[];e.Utils.forEach(c,function(e,t){s=="CategoryFilter"&&console.log("firing",l),t(l,r,i,s,o)})}},subscribe:function(t,n,r){e.EventDispatcher.events[t]||(e.EventDispatcher.events[t]=[]),e.EventDispatcher.events[t]["listener_"+n.__ID__]=r.bind(n)},revoke:function(t,n){delete e.EventDispatcher.events[t]["listener_"+n.__ID__],e.EventDispatcher.events[t].length===0&&delete e.EventDispatcher.events[t]}},e}),n("src/core/object",["./base","./core"],function(e,t){var n=e.extend({_instanceCount:0,__ID__:null,_className:"CydrObject",__construct:function(){n.prototype._instanceCount++,this.__ID__=n.prototype._instanceCount},getClass:function(){return this._className},getID:function(){return this.__ID__},getConfig:function(e,n){return t.Config[this.getClass()]||(t.Config[this.getClass()]=[]),n?(t.Config[this.getClass()][e]||(t.Config[this.getClass()][e]=[]),t.Config[this.getClass()][e][n]):t.Config[this.getClass()][e]},setConfig:function(e,n){t.Config[this.getClass()]||(t.Config[this.getClass()]=[]),t.Config[this.getClass()][e]=n},pushConfig:function(e,n,r){t.Config[this.getClass()]||(t.Config[this.getClass()]=[]),t.Config[this.getClass()][e]||(t.Config[this.getClass()][e]=[]),r?(t.Config[this.getClass()][e][n]||(t.Config[this.getClass()][e][n]=[]),t.Config[this.getClass()][e][n].push(r)):t.Config[this.getClass()][e].push(n)}});return n}),n("src/model/datalist",["../core/core","../core/object"],function(e,t){var n=t.extend({_className:"DataList",isDataList:!0,sortField:null,sortDir:"ASC",limitNumber:null,collection:null,manipulated:!1,__construct:function(e){e||(e=[]),this._super(),this._items=[];for(var t in e)this._items.push(e[t]);this.filters=[],this.resultSet=[]},setCollection:function(e){this.collection=e},getItems:function(){return this._items},push:function(e){return this._items.push(e),console.log("got new data",e),this},filter:function(e,t){return this.filters.push({filter:e,value:t}),this.manipulated=!0,this},sort:function(e,t){return this.sortField=e,this.sortDir=t,this.manipulated=!0,this},limit:function(e){return this.limitNumber=parseInt(e),this.manipulated=!0,this},execute:function(){this.filters.length?e.Utils.forEach(this.filters,function(t,n){var r=n.filter.split(":"),i=r[0],s=r[1];s||(s="EqualTo");switch(s){case"EqualTo":e.Utils.forEach(this._items,function(e,t){t.get(i)==n.value&&this.resultSet.push(t)},this)}},this):this.resultSet=this._items;if(this.sortField){var t=this;this.resultSet=this.resultSet.sort(function(e,n){var r=t.sortDir=="ASC"?!0:!1,i=e.obj(t.sortField).renderSortable(),s=n.obj(t.sortField).renderSortable(),o;return i<s?o=-1:i>s?o=1:o=0,o*[-1,1][+!!r]})}return this.limitNumber&&(this.resultSet=this.resultSet.slice(0,this.limitNumber)),e.Utils.forEach(this.resultSet,function(e,t){t.setCollection(this.collection)},this),this.resultSet},isFalsy:function(){return this._items.length===0},count:function(){return this.execute().length},each:function(e){var t=this.execute();for(var n in t)e(t[n])},reset:function(){this.filters=[],this.sortField=null,this.sortDir="ASC",this.limit=null,this.executed=!1,this.resultSet=[],this.manipulated=!1}});return n}),n("src/datatypes/datatype",["../core/object"],function(e){var t=e.extend({_className:"DataType",_value:"",isDataType:!0,__construct:function(e){this._super(),this._value=e||""},setValue:function(e){this._value=e},getValue:function(){return this._value},isFalsy:function(){return!this._value||this._value==="undefined"?!0:this._value.length===0},toString:function(){return this.getValue()},renderSortable:function(){return this._value}});return t}),n("src/model/model",["../core/core","../datatypes/datatype","./collection","../core/object"],function(e,t,n,r){var i=r.extend({_className:"Model",_mutatedProperties:{},_mutatedCollections:{},properties:{},has_many:{},defaults:{},casting:{},currentBinding:null,isModel:!0,collection:null,viewModel:null,frozen:!1,__construct:function(t){this._super(),this._mutatedProperties={},this._mutatedCollections={},e.Utils.forEach(this.properties,function(e,t){if(!i.Cydr[t]||!i.Cydr[t].prototype.isDataType)throw new Error("DataType '"+t+"' does not exist!");this._mutatedProperties[e]=new i.Cydr[t];var n=new Function("value","if(value !== undefined) {return this.set('"+e+"',value);} try {return this.obj('"+e+"');} catch(e) {console.error(e.message)}");this[e]=n.bind(this)},this),e.Utils.forEach(this.has_many,function(e,t){this._mutatedCollections[e]=new i.Collection(this,t,e);var n=new Function("try {return this.get('"+e+"');} catch(e) {console.error(e.message);}");this[e]=n.bind(this)},this),e.Utils.forEach(this.defaults,function(e,t){this.hasProp(e)&&this._mutatedProperties[e].setValue(t)},this),e.Utils.forEach(t,function(e,t){this.hasProp(e)&&this._mutatedProperties[e].setValue(t)},this),this._mutatedProperties.__id__=r.prototype._instanceCount,this._mutatedProperties.__destroyed__=!1},getClass:function(){return this._className=="Model"?this._classIdentifier:this._className},set:function(e,t){if(i.prototype.frozen)return;if(!this._mutatedProperties[e])throw new Error("Property "+e+" doesn't exist");this._mutatedProperties[e].setValue(t),this.notify(e)},obj:function(t){e.EventDispatcher.fire("ModelAccessed:"+this.getClass()+":"+t+":"+this.getID());if(!this.hasProp(t)&&!this.hasCollection(t)&&typeof this[t]=="function")return this[t]();var n=this._mutatedProperties[t]||this._mutatedCollections[t];if(n===undefined)throw new Error(t+" is not defined");return n},exec:function(e,n){var r=this._mutatedProperties[e]||this._mutatedCollections[e];if(r)return r;if(this[e])return this[e]();if(this.getCachedExpression(e)){var i=this.getCachedExpression(e);try{this.currentBinding=n;var s=i(this,n);this.currentBinding=null}catch(o){return console.error("Could not run expression '"+i.toString()+"'"),console.log(o.message),new t("")}return s}},getCachedExpression:function(e){if(!this.getConfig("cachedExpressions",e)){var t="with(scope) { return "+e+";  }",n=new Function("scope","binding",t);this.pushConfig("cachedExpressions",e,n)}var r=this.getConfig("cachedExpressions",e);return r[0]},isAnalysedExpression:function(e){return this.getConfig("analysedExpressions",e)?!0:!1},getDependenciesForExpression:function(e){return this.getConfig("analysedExpressions",e)},get:function(t){var n;this._mutatedProperties[t]?(e.EventDispatcher.fire("ModelAccessed:"+this.getClass()+":"+t+":"+this.getID()),n=this._mutatedProperties[t].getValue()):this._mutatedCollections[t]&&(e.EventDispatcher.fire("ModelAccessed:"+this.getClass()+":"+t+":"+this.getID()),n=this._mutatedCollections[t]);if(n===undefined)throw console.log(this._mutatedProperties),new Error(t+" does not exist");return n},castFunction:function(e){if(!ret.isDataType&&!ret.isDataList){var t=this.casting[e]||"Text";if(typeof i.Cydr[t]!="function"){console.error("Tried to cast "+e+" as "+t+", but that datatype doesn't exist.");return}return new i.Cydr[t](ret)}return ret},hasProp:function(e){return this.properties.hasOwnProperty(e)},hasCollection:function(e){return this.has_many.hasOwnProperty(e)},getID:function(){return this._mutatedProperties.__id__},Up:function(){if(this.currentBinding&&this.currentBinding.parent)return this.currentBinding.parent.model},bindToElement:function(t,n){var r=new RegExp("^cydr-","i"),s=new RegExp("^[a-z0-9_]+$","i"),o=t.attributes||[];e.Utils.forEach(o,function(e,s){if(r.test(s.name)){var o=s.name.split("-").pop(),u=o.charAt(0).toUpperCase()+o.slice(1)+"Binding";if(typeof i.Cydr[u]=="function"&&i.Cydr[u].prototype.isDataBinding){var a=new i.Cydr[u](this,t,n);a.initialize()}}},this)},applyBindingsToNode:function(t,n){var r=[t],i=t.getElementsByTagName("*")||[],s=[];for(var o in i)s.push(i[o]);s.unshift(t);var u=new RegExp("^cydr-","i");e.Utils.forEach(s,function(e,t){var r=t&&t.attributes?t.attributes:[];if(t&&typeof t.getAttribute=="function"&&!t.getAttribute("cydr-ignore"))for(var i in r)if(u.test(r[i].name)){this.bindToElement(t,n);break}},this)},notify:function(t){e.EventDispatcher.fire("ModelUpdated:"+this.getClass()+":"+t+":"+this.getID()),this.collection&&this.collection.notify()},setCollection:function(e){this.collection=e},getCollection:function(){return this.collection},"delete":function(){this.collection.removeByID(this.getID())},getViewModel:function(){if(this.viewModel)return this.viewModel;var e=this;for(;;){if(!e.getCollection())break;e=e.getCollection().getOwner()}return this.viewModel=e,this.viewModel},subscribeToEvent:function(t,n){e.EventDispatcher.subscribe(t,this,n)},revokeSubscription:function(t){e.EventDispatcher.revoke(t,this)}});return i}),n("src/model/collection",["../core/object","./datalist","./model"],function(e,t,n){var r=e.extend({_className:"Collection",owner:null,model:null,name:null,__construct:function(e,t,n){this.owner=e,this.model=t,this.name=n,this._super(),this._records=[]},count:function(){return this._records.length},get:function(){var e=new t(this._records);return e.setCollection(this),e},each:function(e){return this.get().each(e)},notify:function(){return this.owner.notify(this.name)},push:function(e){if(n.prototype.frozen)return;this._records[e.getID()]=e,this.owner.notify(this.name)},pushMany:function(e){if(n.prototype.frozen)return;e||(e=[]);for(var t in e)this._records[e[t].getID()]=e[t];this.owner.notify(this.name)},removeAll:function(){if(n.prototype.frozen)return;this._records=[],this.owner.notify(this.name)},removeByID:function(e){delete this._records[e],this.owner.notify(this.name)},getOwner:function(){return this.owner}});return r}),n("src/model/viewmodel",["./model"],function(e){var t=e.extend({_className:"ViewModel",__construct:function(e){this._super();var t=document.querySelector(e);t&&this.applyBindingsToNode(t)}});return t}),n("src/model/jsondata",["./model","../core/core"],function(e,t){var n=e.extend({_className:"JSONData",__construct:function(e){typeof e=="object"&&t.Utils.forEach(e,function(e,t){this.properties[e]="Text",this.defaults[e]=t},this),this._super()}});return n}),n("src/datatypes/boolean",["./datatype"],function(e){var t=e.extend({_className:"Boolean",Nice:function(){return this.getValue()?"Yes":"No"},isFalsy:function(){return!this.getValue()},renderSortable:function(){return parseInt(this._value)},getValue:function(){return this._value===1||this._value==="1"||this._value===!0?!0:!1}});return t}),n("src/datatypes/htmltext",["./datatype"],function(e){var t=e.extend({_className:"HTMLText",toString:function(){return this.getValue()},renderSortable:function(){return this._value.toUpperCase()}});return t}),n("src/datatypes/text",["./datatype"],function(e){var t=e.extend({_className:"Text",LimitCharacterCount:function(e){return this.getValue().substring(0,e)},toString:function(){return this.getValue()?this.getValue().toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},renderSortable:function(){return this._value.toUpperCase()}});return t}),n("src/datatypes/float",["./datatype"],function(e){var t=e.extend({_className:"Float",Nice:function(){return this.getValue().toFixed(2)},Round:function(){return Math.round(this.getValue())},isFalsy:function(){return!this.getValue()&&this.getValue()!==0},renderSortable:function(){return parseFloat(this._value)},getValue:function(){var e=parseFloat(this._value);return isNaN(e)?0:e}});return t}),n("src/datatypes/int",["./datatype"],function(e){var t=e.extend({_className:"Int",renderSortable:function(){return this._value},getValue:function(){var e=parseInt(this._value);return isNaN(e)?0:e}});return t}),n("src/bindings/binding",["../core/core","../core/object","../model/model"],function(e,t,n){var r=t.extend({_className:"Binding",isDataBinding:!0,bindingAttribute:"",bindingExec:null,element:null,model:null,exportValueEvent:null,importFunction:null,allowedTags:[],parent:null,__construct:function(e,t,n){this._super(),this.element=t,this.model=e,this.attValue=this.element.getAttribute(this.getBindingAttribute()),this.bindingExec=this.attValue,this.parent=n},initialize:function(){this.allowedTags.length&&!e.Utils.inArray(this.element.tagName,this.allowedTags)&&console.error(this.getBindingAttribute()+"binding must be on one of the following tags: "+this.allowedTags.join(",")+".");if(this.exportValueEvent){var t=this;this.element.addEventListener(this.exportValueEvent,function(){t.exportValue()})}this.element.setAttribute("title","ID: "+this.model.getID()),this.subscribe(),this.importValue()},importValue:function(){},exportValue:function(){},subscribe:function(){if(this.model.hasProp(this.bindingExec)||this.model.hasCollection(this.bindingExec)){var t="ModelUpdated:"+this.model.getClass()+":"+this.bindingExec+":"+this.model.getID(),r=this.element.getAttribute("title")||"";this.element.setAttribute("title",r+"//"+t),e.EventDispatcher.subscribe(t,this,function(){this.importValue()})}else if(!this.model.isAnalysedExpression(this.bindingExec)){var i=this.bindingExec;this.model.subscribeToEvent("ModelAccessed",function(e,t,n,r,s){this.pushConfig("analysedExpressions",i,n+":"+r+":"+s)}),n.prototype.frozen=!0,this.executeBindingExpression(),n.prototype.frozen=!1,this.model.revokeSubscription("ModelAccessed")}var s=this.model.getDependenciesForExpression(this.bindingExec);s&&e.Utils.forEach(s,function(t,n){var r=n.split(":"),i="ModelUpdated:"+r[0]+":"+r[1]+":"+r[2],s=this.element.getAttribute("title")||"";this.element.setAttribute("title",s+"//"+i),e.EventDispatcher.subscribe(i,this,function(){this.importValue()})},this)},getBindingAttribute:function(){var e=this.getClass().replace(/Binding$/,"");return"cydr-"+e.toLowerCase()},create:function(t,n){return new(e[this.getClass()])(t,n)},executeBindingExpression:function(){return this.model.exec(this.bindingExec,this)},getValue:function(){return this.executeBindingExpression()}});return r}),n("src/bindings/checked",["./binding"],function(e){var t=e.extend({_className:"CheckedBinding",allowedTags:["INPUT"],exportValueEvent:"change",isCheckbox:function(){return this.element.type==="checkbox"},isRadio:function(){return this.element.type==="radio"},importValue:function(){var e=this.getValue(),t=this.isCheckbox()?e&&e.isDataType&&!e.isFalsy():e.toString()===this.element.value;t?this.element.setAttribute("checked","checked"):this.element.removeAttribute("checked")},exportValue:function(){var e=this.isCheckbox()?this.element.checked:this.element.value;this.model.set(this.bindingExec,e)}});return t}),n("src/bindings/click",["./binding"],function(e){var t=e.extend({_className:"ClickBinding",initialize:function(){var e=this;this.element.addEventListener("click",function(t){t.preventDefault(),e.executeBindingExpression()}),this._super()},subscribe:function(){return}});return t}),n("src/bindings/content",["./binding"],function(e){var t=e.extend({_className:"ContentBinding",importValue:function(){this.element.innerHTML=this.getValue()}});return t}),n("src/bindings/display",["./binding"],function(e){var t=e.extend({_elementDisplay:[],show:function(e){e.style.display="";var t=e.getAttribute("data-olddisplay");if(t&&t!=="none")return e.style.display=t;var n=this._getStyle(e,"display");if(n==="none"){var r=this._elementDisplay[e.nodeName];if(!r){var i=document.createElement(e.nodeName);document.getElementsByTagName("body")[0].appendChild(i),r=this._getStyle(i,"display"),document.getElementsByTagName("body")[0].removeChild(i),this._elementDisplay[e.nodeName]=r}e.style.display=r}else e.style.display=n},hide:function(e){e.setAttribute("data-olddisplay",e.style.display),e.style.display="none"},_getStyle:function(e,t){var n="";return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,"").getPropertyValue(t):e.currentStyle&&(t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),n=e.currentStyle[t]),n}});return t}),n("src/bindings/hidden",["./display"],function(e){var t=e.extend({_className:"HiddenBinding",importValue:function(){var e=this.getValue();!e||e.isDataType&&e.isFalsy()?this.show(this.element):this.hide(this.element)}});return t}),n("src/bindings/visible",["./display"],function(e){var t=e.extend({_className:"VisibleBinding",importValue:function(){var e=this.getValue();!e||e.isDataType&&e.isFalsy()?this.hide(this.element):this.show(this.element)}});return t}),n("src/bindings/submit",["./binding"],function(e){var t=e.extend({_className:"SubmitBinding",allowedTags:["FORM"],initialize:function(){var e=this;this.element.addEventListener("submit",function(e){e.preventDefault();var t=window.form2object(this.element),n=this.bindingExec;typeof this.model[n]=="function"&&this.model[n](t)}),this._super()},subscribe:function(){return}});return t}),n("src/bindings/value",["../core/core","./binding"],function(e,t){var n=t.extend({_className:"ValueBinding",allowedTags:["INPUT","SELECT"],exportValueEvent:"change",importValue:function(){this.element.tagName=="INPUT"?this.element.value=this.getValue():this.element.tagName=="SELECT"&&e.Utils.forEach(this.element.options,function(e,t){if(t.value==this.getValue().toString())return t.selected=!0,!1},this)},exportValue:function(){if(this.element.tagName=="INPUT")this.model.set(this.bindingExec,this.element.value);else if(this.element.tagName=="SELECT"){var e=this.element.options[this.element.selectedIndex]?this.element.options[this.element.selectedIndex].getAttribute("value"):"";this.model.set(this.bindingExec,e)}}});return n}),n("src/bindings/json/json",["../../model/model","../../core/core","../binding"],function(e,t,n){var r=n.extend({_className:"JSONBinding",subscribe:function(){if(!this.model.isAnalysedExpression(this.bindingExec)){var n=this.bindingExec;this.model.subscribeToEvent("ModelAccessed",function(e,t,r,i,s){this.pushConfig("analysedExpressions",n,r+":"+i+":"+s)}),e.prototype.frozen=!0;var r=this.executeBindingExpression();if(typeof r!="object"){console.error(this.getClass()+" binding must return a JSON object of classname: property/function pairs.");return}t.Utils.forEach(r,function(e,t){typeof t=="function"?t():this.model.exec(t)},this),e.prototype.frozen=!1,this.model.revokeSubscription("ModelAccessed")}var i=this.model.getDependenciesForExpression(this.bindingExec);if(i)for(var s in i){var o=i[s],u=o.split(":");t.EventDispatcher.subscribe("ModelUpdated:"+this.model.getClass()+":"+u[1]+":"+this.model.getID(),this,function(){this.importValue()})}}});return r}),n("src/bindings/json/attr",["../../core/core","./json"],function(e,t){var n=t.extend({_className:"AttrBinding",importValue:function(){typeof this.getValue()!="object"&&console.error(this.getClass()+" binding must return a JSON object of attribute-name: property/function pairs."),e.Utils.forEach(this.getValue(),function(e,t){typeof t=="function"&&this.element.setAttribute(e,t())},this)}});return n}),n("src/bindings/json/extraclasses",["../../core/core","./json"],function(e,t){var n=t.extend({_className:"ExtraclassesBinding",importValue:function(){e.Utils.forEach(this.executeBindingExpression(),function(e,t){var n=new RegExp("(^|\\s)"+e,"g"),r=this.element.className.replace(n,""),i=typeof t=="function"?t():t;if(i===undefined||!i.isDataType&&i!==!0&&i!==!1)return;i===!0||i.isDataType&&!i.isFalsy()?this.element.className+=this.element.className.length?" "+e:e:this.element.className=r},this)}});return n}),n("src/bindings/loop/loop",["../binding"],function(e){var t=e.extend({_className:"LoopBinding",template:null,modelNodeMap:[],nodes:[],tag2holder:{LI:"UL",TR:"TBODY",TBODY:"TABLE",THEAD:"TABLE",TFOOT:"TABLE",TD:"TR",TH:"TR",DT:"DL",DD:"DL"},__construct:function(e,t,n){this.modelNodeMap[this.getID()]=[],this.nodes[this.getID()]=[],this._super(e,t,n)},initialize:function(){(!this.getNodes()||this.getNodes().length===0)&&this.loadTemplate(),this._super()},getNodes:function(){return this.nodes[this.getID()]},addNode:function(e){this.nodes[this.getID()]||(this.nodes[this.getID()]=[]),this.nodes[this.getID()].push(e)},getCachedNodes:function(e){return this.modelNodeMap[this.getID()]||(this.modelNodeMap[this.getID()]=[]),this.modelNodeMap[this.getID()][e]},addCachedNode:function(e,t){this.modelNodeMap[this.getID()]||(this.modelNodeMap[this.getID()]=[]),this.modelNodeMap[this.getID()][e]||(this.modelNodeMap[this.getID()][e]=[]),this.modelNodeMap[this.getID()][e].push(t)},loadTemplate:function(){var e,t,n,r,i,s=this.element.getElementsByTagName("*");for(t in s)e=s[t],typeof e.setAttribute=="function"&&e.setAttribute("cydr-ignore","true");n=this.element.innerHTML,i=this.element.tagName,r=document.createElement(i),r.innerHTML=n,this.clearContents(),s=r.getElementsByTagName("*");for(t in s)e=s[t],typeof e.removeAttribute=="function"&&e.removeAttribute("cydr-ignore");this.template=r;var o=this.template.children[0];this.addNode(o);for(;;){o=o.nextSibling;if(!o)break;o.tagName&&this.addNode(o)}},clearContents:function(){while(this.element.hasChildNodes())this.element.removeChild(this.element.lastChild)},importValue:function(){this.clearContents();var e=this.executeBindingExpression(),t=this;e.each(function(e){var n=t.getCachedNodes(e.getID());if(n)for(var r in n){var i=n[r];t.element.appendChild(i)}else{var s=t.getNodes();for(var r in s){var i=s[r],o=i.cloneNode(!0);t.element.appendChild(o),typeof o.removeAttribute=="function"&&o.removeAttribute("cydr-ignore"),e.applyBindingsToNode(o,t),t.addCachedNode(e.getID(),o)}}})}});return t}),n("src/bindings/loop/options",["../../core/core","./loop"],function(e,t){var n=t.extend({_className:"OptionsBinding",valueField:null,textField:null,caption:null,collection:null,initialize:function(){this.element.tagName!="SELECT"&&console.error("cydr-options binding must be on a select element."),this.valueField=this.element.getAttribute("cydr-optionvalue"),this.textField=this.element.getAttribute("cydr-optiontext"),this.caption=this.element.getAttribute("cydr-optioncaption");var e=this.element.getAttribute("cydr-value");e&&(this.element.removeAttribute("cydr-value"),this.element.setAttribute("cydr-value",e)),this.subscribe(),this.importValue()},importValue:function(){this.clearContents();var e=this.element.getAttribute("cydr-value");e||console.error("cydr-options binding assigned to an element with no cydr-value binding",this.element);if(this.caption){var t=document.createElement("option");t.setAttribute("value",""),t.innerHTML=this.caption,this.element.appendChild(t)}var n=this.executeBindingExpression(),r=this,i=r.element.childNodes;n.each(function(t){var n=document.createElement("option");n.setAttribute("cydr-content",r.textField),n.setAttribute("cydr-attr","{value: "+r.valueField+"}");var i=t.exec(r.valueField),s=r.model.exec(e);i.isDataType&&s.isDataType&&i.getValue()==s.getValue()&&n.setAttribute("selected",!0),r.element.appendChild(n),t.applyBindingsToNode(n,r)})}});return n}),n("src/main",["require","exports","module","./model/collection","./model/model","./model/datalist","./model/viewmodel","./model/jsondata","./datatypes/boolean","./datatypes/htmltext","./datatypes/text","./datatypes/float","./datatypes/int","./bindings/checked","./bindings/click","./bindings/content","./bindings/hidden","./bindings/visible","./bindings/submit","./bindings/value","./bindings/json/attr","./bindings/json/extraclasses","./bindings/loop/loop","./bindings/loop/options"],function(e,t,n){var r={};return r.Collection=e("./model/collection"),r.Model=e("./model/model"),r.DataList=e("./model/datalist"),r.ViewModel=e("./model/viewmodel"),r.JSONData=e("./model/jsondata"),r.Boolean=e("./datatypes/boolean"),r.HTMLText=e("./datatypes/htmltext"),r.Text=e("./datatypes/text"),r.Float=e("./datatypes/float"),r.Int=e("./datatypes/int"),r.CheckedBinding=e("./bindings/checked"),r.ClickBinding=e("./bindings/click"),r.ContentBinding=e("./bindings/content"),r.HiddenBinding=e("./bindings/hidden"),r.VisibleBinding=e("./bindings/visible"),r.SubmitBinding=e("./bindings/submit"),r.ValueBinding=e("./bindings/value"),r.AttrBinding=e("./bindings/json/attr"),r.ExtraclassesBinding=e("./bindings/json/extraclasses"),r.LoopBinding=e("./bindings/loop/loop"),r.OptionsBinding=e("./bindings/loop/options"),r.Model.Cydr=r,r.Model.Collection=r.Collection,r.Collection.Model=r.Model,r});var r={};return r.Collection=t("src/model/collection"),r.Model=t("src/model/model"),r.DataList=t("src/model/datalist"),r.ViewModel=t("src/model/viewmodel"),r.JSONData=t("src/model/jsondata"),r.Boolean=t("src/datatypes/boolean"),r.HTMLText=t("src/datatypes/htmltext"),r.Text=t("src/datatypes/text"),r.Float=t("src/datatypes/float"),r.Int=t("src/datatypes/int"),r.CheckedBinding=t("src/bindings/checked"),r.ClickBinding=t("src/bindings/click"),r.ContentBinding=t("src/bindings/content"),r.HiddenBinding=t("src/bindings/hidden"),r.VisibleBinding=t("src/bindings/visible"),r.SubmitBinding=t("src/bindings/submit"),r.ValueBinding=t("src/bindings/value"),r.AttrBinding=t("src/bindings/json/attr"),r.ExtraclassesBinding=t("src/bindings/json/extraclasses"),r.LoopBinding=t("src/bindings/loop/loop"),r.OptionsBinding=t("src/bindings/loop/options"),r.Model.Cydr=r,r.Model.Collection=r.Collection,r.Collection.Model=r.Model,r});